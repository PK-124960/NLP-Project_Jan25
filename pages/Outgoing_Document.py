import streamlit as st
from datetime import datetime

# ЁЯУМ р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ UI Theme р╣Гр╕лр╣Йр╕нр╕вр╕╣р╣Ир╣Гр╕Щр╣Вр╕Чр╕Щр╣Ар╕Фр╕╡р╕вр╕зр╕Бр╕▒р╕Щ
st.set_page_config(page_title="р╕Бр╕гр╕нр╕Бр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕лр╕Щр╕▒р╕Зр╕кр╕╖р╕нр╕кр╣Ир╕З", layout="wide")
st.markdown("""
    <style>
        body {
            background-color: #FAF3E0;
        }
        .stSidebar {
            background-color: #D4A373;
        }
        .stTextInput > div > div > input {
            border-radius: 8px;
            border: 2px solid #8D6E63;
            padding: 10px;
        }
        .stButton > button {
            background-color: #8D6E63;
            color: white;
            border-radius: 8px;
            padding: 10px;
        }
        .stExpander {
            background-color: #EDE0D4;
            border-radius: 10px;
        }
    </style>
""", unsafe_allow_html=True)

st.title("тЬНя╕П р╕Бр╕гр╕нр╕Бр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕кр╕│р╕лр╕гр╕▒р╕Ър╕кр╕гр╣Йр╕▓р╕Зр╕лр╕Щр╕▒р╕Зр╕кр╕╖р╕нр╕кр╣Ир╕З")

# ЁЯУМ р╣Бр╕кр╕Фр╕Зр╣Ар╕Щр╕╖р╣Йр╕нр╕лр╕▓р╣Ар╕Фр╕┤р╕бр╕Ир╕▓р╕Бр╕лр╕Щр╕▒р╕Зр╕кр╕╖р╕нр╕гр╕▒р╕Ъ
received_content = st.session_state.get("corrected_sections", {}).get("р╣Ар╕Щр╕╖р╣Йр╕нр╕лр╕▓", "р╣Др╕бр╣Ир╕бр╕╡р╕Вр╣Йр╕нр╕бр╕╣р╕е")
if received_content:
    with st.expander("ЁЯУД р╣Ар╕Щр╕╖р╣Йр╕нр╕лр╕▓р╕Ир╕▓р╕Бр╕лр╕Щр╕▒р╕Зр╕кр╕╖р╕нр╕гр╕▒р╕Ъ", expanded=True):
        st.markdown(f"{received_content}")

# ЁЯУМ р╕кр╣Ир╕зр╕Щр╕гр╕▓р╕Кр╕Бр╕▓р╕гр╕Ьр╕╣р╣Йр╕кр╣Ир╕З (Dropdown р╣Ар╕ер╕╖р╕нр╕Бр╕лр╕Щр╣Ир╕зр╕вр╕Зр╕▓р╕Щ)
departments = ["р╕Бр╕нр╕Зр╕Ър╕▒р╕Нр╕Кр╕▓р╕Бр╕▓р╕гр╕Чр╕лр╕▓р╕гр╕кр╕╣р╕Зр╕кр╕╕р╕Ф", "р╕Бр╕нр╕Зр╕Чр╕▒р╕Юр╕Ър╕Б", "р╕Бр╕нр╕Зр╕Чр╕▒р╕Юр╣Ар╕гр╕╖р╕н", "р╕Бр╕нр╕Зр╕Чр╕▒р╕Юр╕нр╕▓р╕Бр╕▓р╕и", "р╕Бр╕гр╕░р╕Чр╕гр╕зр╕Зр╕Бр╕ер╕▓р╣Вр╕лр╕б"]
sender_department = st.selectbox("ЁЯУМ р╕кр╣Ир╕зр╕Щр╕гр╕▓р╕Кр╕Бр╕▓р╕гр╕Ьр╕╣р╣Йр╕кр╣Ир╕З", departments)

# ЁЯУМ р╕Чр╕╡р╣И р╕Бр╕л. р╕Вр╕нр╕Зр╕лр╕Щр╕▒р╕Зр╕кр╕╖р╕нр╕кр╣Ир╕З
document_no = st.text_input("ЁЯУМ р╕Чр╕╡р╣И р╕Бр╕л. р╕Вр╕нр╕Зр╕лр╕Щр╕▒р╕Зр╕кр╕╖р╕нр╕кр╣Ир╕З")

# ЁЯУМ р╕зр╕▒р╕Щр╕Чр╕╡р╣И (р╣Ар╕ер╕╖р╕нр╕Бр╕зр╕▒р╕Щ/р╣Ар╕Фр╕╖р╕нр╕Щ/р╕Ыр╕╡ р╕Ю.р╕и.)
date = st.date_input("ЁЯУЕ р╕зр╕▒р╕Щр╕Чр╕╡р╣Ир╕нр╕нр╕Бр╕лр╕Щр╕▒р╕Зр╕кр╕╖р╕н", datetime.today())

# ЁЯУМ р╣Ар╕гр╕╖р╣Ир╕нр╕З
topic = st.text_input("ЁЯУМ р╣Ар╕гр╕╖р╣Ир╕нр╕З")

# ЁЯУМ р╣Ар╕гр╕╡р╕вр╕Щ
recipient = st.text_input("ЁЯУМ р╣Ар╕гр╕╡р╕вр╕Щ")

# ЁЯУМ р╕нр╣Йр╕▓р╕Зр╕Цр╕╢р╕З (р╕Цр╣Йр╕▓р╕бр╕╡)
reference = st.text_area("ЁЯУМ р╕нр╣Йр╕▓р╕Зр╕Цр╕╢р╕З (р╕Цр╣Йр╕▓р╕бр╕╡)")

# ЁЯУМ р╕кр╕┤р╣Ир╕Зр╕Чр╕╡р╣Ир╕кр╣Ир╕Зр╕бр╕▓р╕Фр╣Йр╕зр╕в (р╕Цр╣Йр╕▓р╕бр╕╡)
attachments = st.text_area("ЁЯУМ р╕кр╕┤р╣Ир╕Зр╕Чр╕╡р╣Ир╕кр╣Ир╕Зр╕бр╕▓р╕Фр╣Йр╕зр╕в (р╕Цр╣Йр╕▓р╕бр╕╡)")

# ЁЯУМ р╕Ьр╕╣р╣Йр╕гр╕▒р╕Ъ (р╕Кр╕▒р╣Йр╕Щр╕вр╕и р╕Кр╕╖р╣Ир╕н - р╕Щр╕▓р╕бр╕кр╕Бр╕╕р╕е)
receiver_name = st.text_input("ЁЯУМ р╕Ьр╕╣р╣Йр╕гр╕▒р╕Ъ (р╕Кр╕▒р╣Йр╕Щр╕вр╕и р╕Кр╕╖р╣Ир╕н - р╕Щр╕▓р╕бр╕кр╕Бр╕╕р╕е)")

# ЁЯУМ р╕Ьр╕╣р╣Йр╕гр╕▒р╕Ъ (р╕Хр╕│р╣Бр╕лр╕Щр╣Ир╕З)
receiver_position = st.text_input("ЁЯУМ р╕Ьр╕╣р╣Йр╕гр╕▒р╕Ъ (р╕Хр╕│р╣Бр╕лр╕Щр╣Ир╕З)")

# ЁЯУМ р╕Ьр╕╣р╣Йр╕Юр╕┤р╕бр╕Юр╣М (р╣Ар╕кр╕бр╕╡р╕вр╕Щ)
clerk_name = st.text_input("ЁЯУМ р╕Ьр╕╣р╣Йр╕Юр╕┤р╕бр╕Юр╣М (р╣Ар╕кр╕бр╕╡р╕вр╕Щ)")

# ЁЯУМ р╕Ыр╕╕р╣Ир╕бр╕Ыр╕гр╕░р╕бр╕зр╕ер╕Ьр╕ер╕Вр╣Йр╕нр╕бр╕╣р╕е
if st.button("ЁЯЪА р╕Фр╕│р╣Ар╕Щр╕┤р╕Щр╕Бр╕▓р╕гр╕кр╕гр╣Йр╕▓р╕Зр╕лр╕Щр╕▒р╕Зр╕кр╕╖р╕нр╕кр╣Ир╕З"):
    if not (sender_department and document_no and topic and recipient and receiver_name and receiver_position and clerk_name):
        st.error("тЭМ р╕Бр╕гр╕╕р╕Ур╕▓р╕Бр╕гр╕нр╕Бр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Гр╕лр╣Йр╕Др╕гр╕Ър╕Чр╕╕р╕Бр╕Кр╣Ир╕нр╕Зр╕Чр╕╡р╣Ир╕Ир╕│р╣Ар╕Ыр╣Зр╕Щ!")
    else:
        # р╣Ар╕Бр╣Зр╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╕ер╕З session state
        st.session_state["document_send"] = {
            "р╕кр╣Ир╕зр╕Щр╕гр╕▓р╕Кр╕Бр╕▓р╕г": sender_department,
            "р╕Чр╕╡р╣И р╕Бр╕л.": document_no,
            "р╕зр╕▒р╕Щр╕Чр╕╡р╣И": date.strftime("%d/%m/%Y"),
            "р╣Ар╕гр╕╖р╣Ир╕нр╕З": topic,
            "р╣Ар╕гр╕╡р╕вр╕Щ": recipient,
            "р╕нр╣Йр╕▓р╕Зр╕Цр╕╢р╕З": reference,
            "р╕кр╕┤р╣Ир╕Зр╕Чр╕╡р╣Ир╕кр╣Ир╕Зр╕бр╕▓р╕Фр╣Йр╕зр╕в": attachments,
            "р╕Ьр╕╣р╣Йр╕гр╕▒р╕Ъ (р╕Кр╕╖р╣Ир╕н-р╕Щр╕▓р╕бр╕кр╕Бр╕╕р╕е)": receiver_name,
            "р╕Ьр╕╣р╣Йр╕гр╕▒р╕Ъ (р╕Хр╕│р╣Бр╕лр╕Щр╣Ир╕З)": receiver_position,
            "р╕Ьр╕╣р╣Йр╕Юр╕┤р╕бр╕Юр╣М": clerk_name,
        }
        
        st.success("тЬЕ р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Цр╕╣р╕Бр╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╣Бр╕ер╣Йр╕з! р╕Бр╕│р╕ер╕▒р╕Зр╕Фр╕│р╣Ар╕Щр╕┤р╕Щр╕Бр╕▓р╕гр╕кр╕гр╣Йр╕▓р╕Зр╕лр╕Щр╕▒р╕Зр╕кр╕╖р╕нр╕кр╣Ир╕З...")
        st.switch_page("pages/generate_document.py")
